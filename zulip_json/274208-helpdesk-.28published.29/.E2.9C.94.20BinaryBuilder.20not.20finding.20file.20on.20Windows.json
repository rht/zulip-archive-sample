[
    {
        "content": "<p>So, finally, with all the help from Mosè, this is what made all work, correctly:</p>\n<ol>\n<li>Replace the Makefile by a <code>CMakeLists.txt</code> and use <code>cmake</code> to build the software.</li>\n<li>Use the flags for <code>cmake</code> as indicated in the <a href=\"https://docs.binarybuilder.org/stable/build_tips/#CMake-builds\">documentation</a></li>\n<li>Use <code>make install</code> instead of <code>install -Dvm ... </code>.</li>\n</ol>\n<p>The final file resulted to be:</p>\n<div class=\"codehilite\" data-code-language=\"Julia\"><pre><span></span><code><span class=\"c\"># Note that this script can accept some limited command-line arguments, run</span>\n<span class=\"c\"># `julia build_tarballs.jl --help` to see a usage message.</span>\n<span class=\"k\">using</span><span class=\"w\"> </span><span class=\"n\">BinaryBuilder</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">Pkg</span>\n\n<span class=\"n\">name</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s\">\"MDLovoFit\"</span>\n<span class=\"n\">version</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"sa\">v</span><span class=\"s\">\"20.0.4\"</span>\n\n<span class=\"c\"># Collection of sources required to complete build</span>\n<span class=\"n\">sources</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"p\">[</span>\n<span class=\"w\">    </span><span class=\"n\">GitSource</span><span class=\"p\">(</span><span class=\"s\">\"https://github.com/m3g/MDLovoFit.git\"</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"s\">\"e320c2a503c9bd88fe2dc102f2abfd0b2f5d4cce\"</span><span class=\"p\">)</span>\n<span class=\"p\">]</span>\n\n<span class=\"c\"># Bash recipe for building across all platforms</span>\n<span class=\"n\">script</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"sa\">raw</span><span class=\"s\">\"\"\"</span>\n<span class=\"s\">cd ${WORKSPACE}/srcdir/MDLovoFit</span>\n<span class=\"s\">install_license LICENSE</span>\n<span class=\"s\">mkdir build &amp;&amp; cd build</span>\n<span class=\"s\">cmake .. \\</span>\n<span class=\"s\">    -DCMAKE_INSTALL_PREFIX=${prefix} \\</span>\n<span class=\"s\">    -DCMAKE_TOOLCHAIN_FILE=${CMAKE_TARGET_TOOLCHAIN} \\</span>\n<span class=\"s\">    -DCMAKE_BUILD_TYPE=Release</span>\n<span class=\"s\">make -j${nproc}</span>\n<span class=\"s\">make install</span>\n<span class=\"s\">\"\"\"</span>\n\n<span class=\"c\"># These are the platforms we will build for by default, unless further</span>\n<span class=\"c\"># platforms are passed in on the command line</span>\n<span class=\"n\">platforms</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">supported_platforms</span><span class=\"p\">()</span>\n<span class=\"n\">platforms</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">expand_gfortran_versions</span><span class=\"p\">(</span><span class=\"n\">platforms</span><span class=\"p\">)</span>\n\n<span class=\"c\"># The products that we will ensure are always built</span>\n<span class=\"n\">products</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"p\">[</span>\n<span class=\"w\">    </span><span class=\"n\">ExecutableProduct</span><span class=\"p\">(</span><span class=\"s\">\"mdlovofit\"</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"ss\">:mdlovofit</span><span class=\"p\">)</span>\n<span class=\"p\">]</span>\n\n<span class=\"c\"># Dependencies that must be installed before this package can be built</span>\n<span class=\"n\">dependencies</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">Dependency</span><span class=\"p\">[</span>\n<span class=\"w\">    </span><span class=\"n\">Dependency</span><span class=\"p\">(</span><span class=\"n\">PackageSpec</span><span class=\"p\">(</span><span class=\"n\">name</span><span class=\"o\">=</span><span class=\"s\">\"CompilerSupportLibraries_jll\"</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">uuid</span><span class=\"o\">=</span><span class=\"s\">\"e66e0078-7015-5450-92f7-15fbd957f2ae\"</span><span class=\"p\">)),</span>\n<span class=\"p\">]</span>\n\n<span class=\"c\"># Build the tarballs, and possibly a `build.jl` as well.</span>\n<span class=\"n\">build_tarballs</span><span class=\"p\">(</span><span class=\"nb\">ARGS</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">name</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">version</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">sources</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">script</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">platforms</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">products</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">dependencies</span><span class=\"p\">;</span><span class=\"w\"> </span><span class=\"n\">julia_compat</span><span class=\"o\">=</span><span class=\"s\">\"1.6\"</span><span class=\"p\">)</span>\n</code></pre></div>",
        "id": 374548143,
        "sender_full_name": "Leandro Martínez",
        "timestamp": 1689154399
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"455681\">Leandro Martínez</span> has marked this topic as resolved.</p>",
        "id": 374548245,
        "sender_full_name": "Notification Bot",
        "timestamp": 1689154420
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"632417\">Francois Van Zyl</span> has marked this topic as unresolved.</p>",
        "id": 374880914,
        "sender_full_name": "Notification Bot",
        "timestamp": 1689244696
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"632417\">Francois Van Zyl</span> has marked this topic as resolved.</p>",
        "id": 374881150,
        "sender_full_name": "Notification Bot",
        "timestamp": 1689244749
    }
]